% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scCanonical.R
\name{add_specificity}
\alias{add_specificity}
\title{Calculate Specificity Score for Differential Expression Results}
\usage{
add_specificity(df)
}
\arguments{
\item{df}{A data frame containing differential expression results, typically
from Seurat's \code{FindConservedMarkers} or similar functions. It must include
columns \code{avg_log2FC}, \code{pct.1}, and \code{pct.2} for the specificity score to be
calculated; otherwise, the score will be set to \code{NA}.}
}
\value{
A data frame identical to the input \code{df}, with an additional column
\code{spec_score} containing the specificity score for each gene. The score is
calculated as \code{avg_log2FC * max(0, pct.1 - pct.2)}. If the required columns
(\code{avg_log2FC}, \code{pct.1}, \code{pct.2}) are not present, \code{spec_score} is set to
\code{NA_real_}.
}
\description{
This function calculates a specificity score for each gene in a differential
expression data frame, based on the log2 fold-change and the difference in
expression percentages between two groups.
}
\details{
The specificity score quantifies the degree of differential expression by
combining the log2 fold-change (\code{avg_log2FC}) with the difference in the
percentage of cells expressing the gene in the target group (\code{pct.1}) versus
the reference group (\code{pct.2}). The \code{pmax(0, pct.1 - pct.2)} ensures that only
positive differences contribute to the score, emphasizing genes more specific
to the target group.
}
\examples{
\dontrun{
# Example data frame with differential expression results
de_results <- data.frame(
  gene = c("Gene1", "Gene2"),
  avg_log2FC = c(1.5, 0.8),
  pct.1 = c(0.9, 0.4),
  pct.2 = c(0.2, 0.5)
)
result <- add_specificity(de_results)
print(result)
}

}
