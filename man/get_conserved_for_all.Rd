% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scCanonical.R
\name{get_conserved_for_all}
\alias{get_conserved_for_all}
\title{Identify Conserved Markers Across All Clusters}
\usage{
get_conserved_for_all(
  obj,
  grouping.var = "condition",
  min.pct = 0.1,
  logfc.threshold = 0.25,
  pval_meta_cutoff = 0.05,
  min.cells.per.group = 3
)
}
\arguments{
\item{obj}{A Seurat object containing single-cell data.}

\item{grouping.var}{Character string specifying the metadata column used to
define groups (default: "condition").}

\item{min.pct}{Numeric value specifying the minimum fraction of cells in which
a gene must be expressed to be considered (default: 0.1).}

\item{logfc.threshold}{Numeric value specifying the minimum log fold-change
threshold for differential expression (default: 0.25).}

\item{pval_meta_cutoff}{Numeric value specifying the p-value cutoff for
filtering conserved markers (default: 0.05).}

\item{min.cells.per.group}{Integer specifying the minimum number of cells per
group required to perform the conserved marker test (default: 3).}
}
\value{
A list with two elements:
\itemize{
\item \code{results}: A data frame containing conserved marker genes for
each cluster, including gene names, cluster identifiers, and relevant
statistics. Returns an empty data frame if no results meet the criteria.
\item \code{skipped}: A data frame listing clusters that were skipped due
to insufficient cells or missing groups, including cluster IDs, group
names, and cell counts. Returns an empty data frame if no clusters were
skipped.
}
}
\description{
This function identifies conserved markers for each cluster in a Seurat object
across different groups defined by a grouping variable. It uses Seurat's
\code{FindConservedMarkers} function and filters results based on specified criteria.
}
\details{
The function sets the identities of the Seurat object to "seurat_clusters" and
iterates through each cluster to identify conserved markers using
\code{FindConservedMarkers}. Clusters with insufficient cells (fewer than
\code{min.cells.per.group}) in any group or missing groups are skipped, and a message
is printed. Results are filtered based on the specified p-value cutoff
(\code{pval_meta_cutoff}) using the appropriate p-value column (\code{max_pval},
\code{p_val_adj}, or \code{p_val}) depending on the Seurat version. The function uses
\code{dplyr::bind_rows} to combine results and skipped cluster information.
}
\examples{
\dontrun{
# Assuming 'seurat_obj' is a Seurat object
result <- get_conserved_for_all(
  obj = seurat_obj,
  grouping.var = "condition",
  min.pct = 0.1,
  logfc.threshold = 0.25,
  pval_meta_cutoff = 0.05,
  min.cells.per.group = 3
)
print(result$results)
print(result$skipped)
}

}
